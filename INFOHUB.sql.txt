BEGIN
    --grava registros no histórico
    INSERT INTO CETIP.GRP_INFO_PARTICIPANTE_ENV_HIST (
      NUM_ID_GRP_INFO_PART_ENV_HIST,
      NUM_ID_GRP_INFO_PART_ENVIADA,
      NUM_CONTA_PARTICIPANTE,
      NUM_IF,
      COD_IF,
      NUM_TIPO_IF,
      NUM_ID_GRP_INFORMACAO,
      NUM_ID_FONTE_GERADORA_MENSAGEM,
      DAT_INCLUSAO,
      DAT_HISTORICO,
      COD_SITUACAO_OPERACAO
    )
      SELECT
        CETIP.S_GRP_INFO_PART_ENV_HIST.NEXTVAL,
        NUM_ID_GRP_INFO_PART_ENVIADA,
        NUM_CONTA_PARTICIPANTE,
        NUM_IF,
        COD_IF,
        NUM_TIPO_IF,
        NUM_ID_GRP_INFORMACAO,
        NUM_ID_FONTE_GERADORA_MENSAGEM,
        DAT_INCLUSAO,
        SYSDATE DAT_HISTORICO,
        COD_SITUACAO_OPERACAO
      FROM CETIP.GRP_INFO_PARTICIPANTE_ENVIADA;
    
    --limpa tabela
    --EXECUTE IMMEDIATE 'TRUNCATE TABLE CETIP.GRP_INFO_PARTICIPANTE_ENVIADA';
    DELETE FROM CETIP.GRP_INFO_PARTICIPANTE_ENVIADA;
END;


--select count(1) from CETIP.GRP_INFO_PARTICIPANTE_ENVIADA;