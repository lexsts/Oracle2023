SET SERVEROUTPUT ON;
SET ECHO OFF;
SET FEEDBACK ON;
SET PAGESIZE 0;
SET TIMING ON;

Declare

BEGIN

       SEGUROS.PROC_DROP_INDEX('IE01_VM_APOLICES_RAMOS');

        EXECUTE IMMEDIATE 'ALTER SESSION FORCE PARALLEL DML PARALLEL 16';
        EXECUTE IMMEDIATE 'ALTER SESSION FORCE PARALLEL QUERY PARALLEL 16';

        DBMS_MVIEW.REFRESH('SEGUROS.VM_APOLICES_RAMOS', ATOMIC_REFRESH=>FALSE);

       SEGUROS.PROC_CREATE_INDEX('IE01_VM_APOLICES_RAMOS', 'VM_APOLICES_RAMOS', '"NUM_IDT_APOLICE", "COD_COMPOSICAO"');

        EXCEPTION
                WHEN Others THEN
                        Dbms_Output.Put_Line ('Errors: '|| SQLERRM);
                        raise_application_error(-20000, 'Errors: '|| SQLERRM);

END;
/
